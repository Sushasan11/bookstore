---
phase: 32-validation-and-docs
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/milestones/v3.1-phases/26-admin-foundation/26-02-SUMMARY.md
  - .planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-SUMMARY.md
  - .planning/phases/31-code-quality/31-02-SUMMARY.md
  - frontend/src/types/api.generated.ts
autonomous: true
requirements:
  - DOCS-01

must_haves:
  truths:
    - "26-02-SUMMARY.md frontmatter requirements-completed lists the correct requirement IDs that plan 26-02 actually delivered"
    - "27-01-SUMMARY.md frontmatter requirements-completed lists the correct requirement IDs that plan 27-01 actually delivered"
    - "31-02-SUMMARY.md frontmatter includes requirements-completed with ANLY-01"
    - "api.generated.ts includes the period query param for the top-books endpoint"
  artifacts:
    - path: ".planning/milestones/v3.1-phases/26-admin-foundation/26-02-SUMMARY.md"
      provides: "Corrected SUMMARY frontmatter for plan 26-02"
      contains: "requirements-completed"
    - path: ".planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-SUMMARY.md"
      provides: "Corrected SUMMARY frontmatter for plan 27-01"
      contains: "requirements-completed"
    - path: ".planning/phases/31-code-quality/31-02-SUMMARY.md"
      provides: "Corrected SUMMARY frontmatter for plan 31-02"
      contains: "requirements-completed"
    - path: "frontend/src/types/api.generated.ts"
      provides: "Regenerated OpenAPI types with period param"
      contains: "period"
  key_links:
    - from: "26-02-PLAN.md requirements field"
      to: "26-02-SUMMARY.md requirements-completed field"
      via: "PLAN requirements should match SUMMARY requirements-completed"
      pattern: "requirements-completed"
---

<objective>
Correct the requirements-completed frontmatter in three SUMMARY files (26-02, 27-01, 31-02) to accurately reflect the requirement IDs each plan delivered, and regenerate api.generated.ts to include the period query param on the top-books endpoint.

Purpose: Planning document history must be accurate for milestone auditing. The v4.1 audit found that SUMMARY frontmatter had incorrect or missing requirement IDs, and api.generated.ts was stale after adding the period parameter.

Output: Three corrected SUMMARY files and a regenerated api.generated.ts.
</objective>

<execution_context>
@C:/Users/Sushasan/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Sushasan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-validation-and-docs/32-CONTEXT.md
@.planning/v4.1-MILESTONE-AUDIT.md

@.planning/milestones/v3.1-phases/26-admin-foundation/26-02-SUMMARY.md
@.planning/milestones/v3.1-phases/26-admin-foundation/26-02-PLAN.md
@.planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-SUMMARY.md
@.planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-PLAN.md
@.planning/phases/31-code-quality/31-02-SUMMARY.md

<interfaces>
<!-- Cross-reference data for determining correct requirement IDs -->

26-02-PLAN.md frontmatter:
```yaml
requirements:
  - DASH-01
  - DASH-02
  - DASH-03
  - DASH-04
  - DASH-05
```

26-02-SUMMARY.md current frontmatter:
```yaml
requirements-completed: [DASH-01, DASH-02, DASH-03, DASH-04, DASH-05]
```
NOTE: These are v3.1 milestone requirement IDs. Cross-reference with
the v3.1 requirements to verify correctness. The SUMMARY content confirms:
admin fetch layer, KPI cards, period selector, delta badges, low-stock card,
top-5 best-sellers. These map to DASH-01 through DASH-05.

27-01-PLAN.md frontmatter:
```yaml
requirements:
  - SALE-01
  - SALE-02
  - SALE-03
  - SALE-04
```

27-01-SUMMARY.md current frontmatter:
```yaml
requirements-completed: [SALE-01, SALE-02, SALE-03, SALE-04]
```
NOTE: Cross-reference with v3.1 requirements. The SUMMARY content confirms:
RevenueChart, Sales Analytics page with KPI cards, top-sellers table with
sort toggle and limit selector. These map to SALE-01 through SALE-04.

31-02-SUMMARY.md current frontmatter:
```yaml
# MISSING: requirements-completed field entirely
```
The plan addresses ANLY-01 (period-filtered top-sellers) and the
VERIFICATION.md confirms it as SATISFIED. Must add:
```yaml
requirements-completed: [ANLY-01]
```

api.generated.ts regeneration:
```bash
# In frontend/ directory with backend running on localhost:8000:
npm run generate-types
# This runs: openapi-typescript http://localhost:8000/openapi.json -o src/types/api.generated.ts
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix SUMMARY frontmatter in 26-02, 27-01, and 31-02</name>
  <files>.planning/milestones/v3.1-phases/26-admin-foundation/26-02-SUMMARY.md, .planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-SUMMARY.md, .planning/phases/31-code-quality/31-02-SUMMARY.md</files>
  <action>
**Cross-reference methodology:** For each SUMMARY, compare the PLAN.md `requirements` field with the SUMMARY's `requirements-completed` field and the actual work described in the SUMMARY body. The SUMMARY should list exactly the requirement IDs the plan claimed AND delivered.

**26-02-SUMMARY.md:**
- Current: `requirements-completed: [DASH-01, DASH-02, DASH-03, DASH-04, DASH-05]`
- PLAN claims: `DASH-01, DASH-02, DASH-03, DASH-04, DASH-05`
- SUMMARY body confirms: admin fetch layer, 4 KPI cards, period selector, delta badges, low-stock card, top-5 best-sellers
- **Action:** These IDs are correct and match the plan + delivered work. No change needed. Verify and leave as-is.

**27-01-SUMMARY.md:**
- Current: `requirements-completed: [SALE-01, SALE-02, SALE-03, SALE-04]`
- PLAN claims: `SALE-01, SALE-02, SALE-03, SALE-04`
- SUMMARY body confirms: RevenueChart, Sales Analytics page, KPI cards, top-sellers with sort toggle and limit selector
- **Action:** These IDs are correct and match the plan + delivered work. No change needed. Verify and leave as-is.

**31-02-SUMMARY.md:**
- Current: **MISSING** `requirements-completed` field entirely
- PLAN claims: `ANLY-01` (period-filtered top-sellers)
- SUMMARY body confirms: period filtering on backend top-books endpoint + frontend wiring
- Milestone audit flags: "31-02-SUMMARY.md frontmatter missing requirements-completed: [ANLY-01]"
- **Action:** Add `requirements-completed: [ANLY-01]` to the YAML frontmatter. Insert it after the `decisions` block and before the `metrics` block, maintaining consistent formatting with the other SUMMARY files. The field should be:
  ```yaml
  requirements-completed: [ANLY-01]
  ```

If 26-02 and 27-01 already have correct IDs (which they appear to), the primary fix is adding the missing field to 31-02. However, still READ each file to confirm — do not assume. If any discrepancy is found between PLAN requirements and SUMMARY requirements-completed, fix it.
  </action>
  <verify>
    <automated>cd D:/Python/claude-test && python -c "
import re
files = [
    ('.planning/milestones/v3.1-phases/26-admin-foundation/26-02-SUMMARY.md', ['DASH-01','DASH-02','DASH-03','DASH-04','DASH-05']),
    ('.planning/milestones/v3.1-phases/27-sales-analytics-and-inventory-alerts/27-01-SUMMARY.md', ['SALE-01','SALE-02','SALE-03','SALE-04']),
    ('.planning/phases/31-code-quality/31-02-SUMMARY.md', ['ANLY-01']),
]
for path, expected_ids in files:
    content = open(path).read()
    match = re.search(r'requirements-completed:\s*\[([^\]]+)\]', content)
    assert match, f'{path}: requirements-completed field MISSING'
    found_ids = [x.strip() for x in match.group(1).split(',')]
    assert sorted(found_ids) == sorted(expected_ids), f'{path}: expected {expected_ids}, found {found_ids}'
    print(f'{path}: OK ({found_ids})')
print('ALL PASS')
"</automated>
  </verify>
  <done>All three SUMMARY files have correct requirements-completed fields: 26-02 lists DASH-01 through DASH-05, 27-01 lists SALE-01 through SALE-04, 31-02 lists ANLY-01.</done>
</task>

<task type="auto">
  <name>Task 2: Regenerate api.generated.ts from backend OpenAPI spec</name>
  <files>frontend/src/types/api.generated.ts</files>
  <action>
Regenerate `frontend/src/types/api.generated.ts` from the backend's OpenAPI spec. This is a one-time regeneration to pick up the `period` query param added to the top-books endpoint in Phase 31-02.

Steps:
1. Start the backend server: `cd backend && python -m uvicorn app.main:app --port 8000` (in background)
2. Wait for server ready (curl health endpoint)
3. Run type generation: `cd frontend && npm run generate-types`
   - This executes: `openapi-typescript http://localhost:8000/openapi.json -o src/types/api.generated.ts`
4. Stop the backend server
5. Verify the generated file contains the `period` parameter for the top-books endpoint

The generated file should now include something like:
```typescript
// In the get_top_books operation parameters:
period?: string;
```

Do NOT manually edit api.generated.ts — it must be machine-generated from the OpenAPI spec.
  </action>
  <verify>
    <automated>cd D:/Python/claude-test && grep -n "period" frontend/src/types/api.generated.ts | head -10</automated>
  </verify>
  <done>api.generated.ts has been regenerated and includes the period query parameter for the top-books endpoint.</done>
</task>

</tasks>

<verification>
1. `31-02-SUMMARY.md` frontmatter contains `requirements-completed: [ANLY-01]`
2. `26-02-SUMMARY.md` frontmatter contains correct requirement IDs matching its PLAN
3. `27-01-SUMMARY.md` frontmatter contains correct requirement IDs matching its PLAN
4. `api.generated.ts` contains `period` parameter definition for the top-books endpoint
5. `api.generated.ts` was regenerated (not manually edited) — check the auto-generated header comment
</verification>

<success_criteria>
- All three SUMMARY files have accurate requirements-completed fields matching what their plans claimed and delivered
- api.generated.ts is regenerated from the live OpenAPI spec and includes the period query param for top-books
- No manual edits to api.generated.ts — purely machine-generated
</success_criteria>

<output>
After completion, create `.planning/phases/32-validation-and-docs/32-02-SUMMARY.md`
</output>
