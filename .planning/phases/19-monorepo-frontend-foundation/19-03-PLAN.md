---
phase: 19-monorepo-frontend-foundation
plan: 03
type: execute
wave: 3
depends_on:
  - 19-02
files_modified:
  - frontend/src/components/layout/Header.tsx
  - frontend/src/components/layout/Footer.tsx
  - frontend/src/components/layout/MobileNav.tsx
  - frontend/src/components/layout/ThemeToggle.tsx
  - frontend/src/app/layout.tsx
  - frontend/src/app/page.tsx
autonomous: false
requirements:
  - FOUND-06

must_haves:
  truths:
    - "The browser renders a header with logo/site name, navigation links, and user action area (cart icon, theme toggle)"
    - "On mobile viewport (< 768px), the header shows a hamburger menu that opens a slide-out drawer with navigation links"
    - "On desktop viewport (>= 768px), navigation links are visible directly in the header"
    - "A footer is visible at the bottom of the page with copyright and basic links"
    - "The dark mode toggle switches between light and dark themes and the change persists across page navigation"
    - "The home page calls the backend `/health` endpoint and displays the backend status (proves CORS + fetch wrapper + TanStack Query work end-to-end)"
  artifacts:
    - path: "frontend/src/components/layout/Header.tsx"
      provides: "Responsive top navbar with logo, nav links, mobile hamburger, cart icon, theme toggle"
      exports: ["Header"]
    - path: "frontend/src/components/layout/Footer.tsx"
      provides: "Minimal footer with copyright and links"
      exports: ["Footer"]
    - path: "frontend/src/components/layout/MobileNav.tsx"
      provides: "Sheet-based slide-out mobile navigation drawer"
      exports: ["MobileNav"]
    - path: "frontend/src/components/layout/ThemeToggle.tsx"
      provides: "Dark/light mode toggle button using next-themes"
      exports: ["ThemeToggle"]
    - path: "frontend/src/app/page.tsx"
      provides: "Home page with health check smoke test"
    - path: "frontend/src/app/layout.tsx"
      provides: "Root layout with Header and Footer wrapping main content"
  key_links:
    - from: "frontend/src/components/layout/Header.tsx"
      to: "frontend/src/components/layout/MobileNav.tsx"
      via: "Header renders MobileNav (visible on mobile only)"
      pattern: "<MobileNav"
    - from: "frontend/src/components/layout/Header.tsx"
      to: "frontend/src/components/layout/ThemeToggle.tsx"
      via: "Header renders ThemeToggle in the actions area"
      pattern: "<ThemeToggle"
    - from: "frontend/src/app/layout.tsx"
      to: "frontend/src/components/layout/Header.tsx"
      via: "Root layout renders Header above main content"
      pattern: "<Header"
    - from: "frontend/src/app/layout.tsx"
      to: "frontend/src/components/layout/Footer.tsx"
      via: "Root layout renders Footer below main content"
      pattern: "<Footer"
    - from: "frontend/src/app/page.tsx"
      to: "frontend/src/lib/api.ts"
      via: "Health check query calls apiFetch('/health')"
      pattern: "apiFetch.*health"
---

<objective>
Build the responsive layout shell (header, mobile navigation, footer, dark mode toggle) and a health check smoke test page that proves the full frontend-to-backend pipeline works (CORS, fetch wrapper, TanStack Query).

Purpose: Delivers the visual foundation for all storefront pages and validates the complete integration stack. Every subsequent page will render inside this layout shell.
Output: Responsive header with mobile hamburger menu, footer, dark mode toggle, and a home page that successfully fetches from the FastAPI backend.
</objective>

<execution_context>
@C:/Users/Sushasan/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Sushasan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/19-monorepo-frontend-foundation/19-RESEARCH.md
@.planning/phases/19-monorepo-frontend-foundation/19-02-SUMMARY.md

<interfaces>
<!-- Key types and contracts from Plan 19-02 that this plan depends on. -->

From frontend/src/lib/api.ts:
```typescript
export class ApiError extends Error {
  constructor(message: string, public status: number, public detail?: string)
}
export async function apiFetch<T>(path: string, options?: RequestInit): Promise<T>
```

From frontend/src/components/providers.tsx:
```typescript
export function Providers({ children }: { children: React.ReactNode }): JSX.Element
// Wraps: QueryClientProvider + ThemeProvider + Toaster + ReactQueryDevtools
```

From frontend/src/components/ui/ (shadcn):
- Button: `import { Button } from '@/components/ui/button'`
- Sheet/SheetContent/SheetTrigger: `import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet'`

From backend /health endpoint:
```json
{"status": "ok", "version": "1.0.0"}
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create layout components (Header, MobileNav, Footer, ThemeToggle)</name>
  <files>
    frontend/src/components/layout/Header.tsx
    frontend/src/components/layout/MobileNav.tsx
    frontend/src/components/layout/Footer.tsx
    frontend/src/components/layout/ThemeToggle.tsx
  </files>
  <action>
Create four layout components under `frontend/src/components/layout/`. All use the clean modern aesthetic (Vercel/Linear) specified in locked decisions: white space, subtle shadows, rounded corners, system font stack.

**ThemeToggle (`frontend/src/components/layout/ThemeToggle.tsx`):**

A `'use client'` component using `next-themes` `useTheme()`. Must handle hydration mismatch by rendering only after mount (`useEffect(() => setMounted(true), [])`). Sun/Moon icons from `lucide-react`. Uses shadcn/ui `Button` with `variant="ghost"` and `size="icon"`. Returns `null` before mount to prevent hydration mismatch.

```typescript
'use client'
import { useTheme } from 'next-themes'
import { Button } from '@/components/ui/button'
import { Moon, Sun } from 'lucide-react'
import { useEffect, useState } from 'react'

export function ThemeToggle() {
  const { setTheme, theme } = useTheme()
  const [mounted, setMounted] = useState(false)
  useEffect(() => setMounted(true), [])
  if (!mounted) return null

  return (
    <Button
      variant="ghost"
      size="icon"
      onClick={() => setTheme(theme === 'dark' ? 'light' : 'dark')}
      aria-label="Toggle theme"
    >
      <Sun className="h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" />
      <Moon className="absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" />
    </Button>
  )
}
```

**MobileNav (`frontend/src/components/layout/MobileNav.tsx`):**

A `'use client'` component using shadcn/ui `Sheet` for a slide-out drawer. Triggered by a hamburger button (`Menu` icon from `lucide-react`). Only visible on mobile (`md:hidden` on the trigger). Navigation links: Home (`/`), Books (`/books`), Cart (`/cart`). Uses `next/link` for client-side navigation. Sheet closes when a link is clicked (control the open state with `useState`).

Navigation links list:
```typescript
const navLinks = [
  { href: '/', label: 'Home' },
  { href: '/books', label: 'Books' },
  { href: '/cart', label: 'Cart' },
]
```

**Header (`frontend/src/components/layout/Header.tsx`):**

A server-safe component (no `'use client'` needed if it only composes client components). Structure:

```
<header> (sticky top-0, z-50, border-bottom, bg-background/95 backdrop-blur)
  <div> (max-w-7xl mx-auto, flex items-center justify-between, h-16, px-4)
    <!-- Left: Mobile hamburger + Logo -->
    <div class="flex items-center gap-4">
      <MobileNav />  <!-- Only visible on mobile (md:hidden internally) -->
      <Link href="/" class="font-bold text-xl">Bookstore</Link>
    </div>

    <!-- Center: Desktop nav links (hidden on mobile) -->
    <nav class="hidden md:flex items-center gap-6">
      <Link href="/books">Books</Link>
      <!-- More links added in later phases -->
    </nav>

    <!-- Right: Actions -->
    <div class="flex items-center gap-2">
      <Link href="/cart">
        <Button variant="ghost" size="icon">
          <ShoppingCart class="h-5 w-5" />
        </Button>
      </Link>
      <ThemeToggle />
    </div>
  </div>
</header>
```

Icons from `lucide-react`: `ShoppingCart`, `Menu`. Import `Link` from `next/link`. Styling follows mobile-first approach — nav links hidden on small screens, visible from `md:` breakpoint.

**Footer (`frontend/src/components/layout/Footer.tsx`):**

Minimal footer with copyright and placeholder links. Not interactive, no `'use client'` needed.

```
<footer> (border-top, mt-auto)
  <div> (max-w-7xl mx-auto, py-8 px-4)
    <div> (flex flex-col md:flex-row justify-between items-center gap-4)
      <p class="text-sm text-muted-foreground">
        &copy; 2026 Bookstore. All rights reserved.
      </p>
      <nav class="flex gap-4 text-sm text-muted-foreground">
        <Link href="/books">Browse Books</Link>
        <Link href="/cart">Cart</Link>
      </nav>
    </div>
  </div>
</footer>
```

Use `text-muted-foreground` from shadcn/ui tokens for subtle text. Use `border-border` from tokens for divider color.
  </action>
  <verify>
    <automated>cd frontend && npx tsc --noEmit 2>&1 | tail -10</automated>
  </verify>
  <done>Four layout components created: `Header.tsx` (sticky navbar with logo, desktop nav, cart icon, theme toggle), `MobileNav.tsx` (Sheet-based slide-out drawer with hamburger trigger), `Footer.tsx` (minimal copyright + links), `ThemeToggle.tsx` (sun/moon toggle with hydration guard). All compile without TypeScript errors.</done>
</task>

<task type="auto">
  <name>Task 2: Wire layout shell into root layout and create health check home page</name>
  <files>
    frontend/src/app/layout.tsx
    frontend/src/app/page.tsx
  </files>
  <action>
**Part A — Update root layout (`frontend/src/app/layout.tsx`):**

Add Header and Footer to the root layout, wrapping the `{children}` slot. The layout creates the page structure: sticky header at top, flexible main content area, footer at bottom.

```typescript
import type { Metadata } from 'next'
import { Providers } from '@/components/providers'
import { Header } from '@/components/layout/Header'
import { Footer } from '@/components/layout/Footer'
import './globals.css'

export const metadata: Metadata = {
  title: {
    default: 'Bookstore',
    template: '%s | Bookstore',
  },
  description: 'Discover and purchase books from our curated catalog',
}

export default function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode
}>) {
  return (
    <html lang="en" suppressHydrationWarning>
      <body className="min-h-screen bg-background font-sans antialiased">
        <Providers>
          <div className="relative flex min-h-screen flex-col">
            <Header />
            <main className="flex-1">{children}</main>
            <Footer />
          </div>
        </Providers>
      </body>
    </html>
  )
}
```

Note: `title.template` with `%s | Bookstore` allows child pages to set just their title (e.g., `"Books"` renders as `"Books | Bookstore"`).

**Part B — Health check smoke test (`frontend/src/app/page.tsx`):**

Replace the default Next.js page with a health check that proves the full stack works: CORS, `apiFetch`, TanStack Query, and the layout shell.

```typescript
'use client'

import { useQuery } from '@tanstack/react-query'
import { apiFetch } from '@/lib/api'

interface HealthResponse {
  status: string
  version: string
}

export default function HomePage() {
  const { data, isLoading, error } = useQuery({
    queryKey: ['health'],
    queryFn: () => apiFetch<HealthResponse>('/health'),
  })

  return (
    <div className="container mx-auto px-4 py-16">
      <div className="mx-auto max-w-2xl text-center">
        <h1 className="text-4xl font-bold tracking-tight">
          Welcome to Bookstore
        </h1>
        <p className="mt-4 text-lg text-muted-foreground">
          Discover and purchase books from our curated catalog.
        </p>

        {/* Health check status — proves full stack integration */}
        <div className="mt-8 rounded-lg border p-6">
          <h2 className="text-sm font-medium text-muted-foreground mb-2">
            Backend Status
          </h2>
          {isLoading && (
            <p className="text-muted-foreground">Checking backend...</p>
          )}
          {error && (
            <p className="text-destructive">
              Backend unreachable: {error.message}
            </p>
          )}
          {data && (
            <p className="text-green-600 dark:text-green-400">
              Connected — v{data.version}
            </p>
          )}
        </div>
      </div>
    </div>
  )
}
```

This page is a temporary smoke test. In later phases, the home page will be replaced with the actual catalog. For now it proves:
1. TanStack Query works (useQuery fires)
2. apiFetch wrapper works (calls backend)
3. CORS works (no browser console errors)
4. The layout shell renders (Header above, Footer below)
5. Dark mode works (toggle in header, colors change)

After creating both files, verify end-to-end by running both servers:
- Terminal 1: `cd backend && poetry run task dev` (port 8000)
- Terminal 2: `cd frontend && npm run dev` (port 3000)
- Visit http://localhost:3000 — should see "Welcome to Bookstore" with "Connected — v1.0.0" status
  </action>
  <verify>
    <automated>cd frontend && npm run build 2>&1 | tail -5</automated>
  </verify>
  <done>Root layout wraps all pages in Header + main + Footer with flex column layout. Home page renders welcome message and calls `/health` endpoint via TanStack Query + apiFetch. When both servers are running, the page shows "Connected — v1.0.0" with no CORS errors. Mobile viewport shows hamburger menu; desktop shows inline nav links. Dark mode toggle works.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Verify responsive layout and backend connectivity</name>
  <files>frontend/src/app/page.tsx</files>
  <action>
What was built: Complete layout shell (Header, MobileNav, Footer, ThemeToggle) and health check smoke test that proves frontend-to-backend connectivity.

How to verify:
1. Start both servers:
   - Terminal 1: `cd backend && poetry run task dev`
   - Terminal 2: `cd frontend && npm run dev`
2. Open http://localhost:3000 in the browser
3. Verify the header is visible with "Bookstore" logo, nav links, cart icon, and theme toggle
4. Verify the page shows "Connected — v1.0.0" (proves CORS + API + TanStack Query work)
5. Click the theme toggle (sun/moon) — colors should switch between light and dark
6. Resize the browser to mobile width (< 768px):
   - Nav links should be hidden
   - Hamburger menu icon should appear
   - Click hamburger — slide-out drawer should open with navigation links
7. Open browser DevTools Console — verify NO CORS errors
8. Scroll down — footer should be visible with copyright text

Resume signal: Type "approved" or describe any issues with the layout, responsiveness, or backend connectivity.
  </action>
  <verify>
    <automated>cd frontend && npm run build 2>&1 | tail -5</automated>
  </verify>
  <done>User has visually confirmed: responsive header (desktop nav + mobile hamburger), footer, dark mode toggle, and "Connected — v1.0.0" health check status with no CORS errors.</done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run build` — production build succeeds
2. `cd frontend && npx tsc --noEmit` — zero TypeScript errors
3. Layout components exist: `Header.tsx`, `Footer.tsx`, `MobileNav.tsx`, `ThemeToggle.tsx`
4. Home page fetches from `/health` endpoint and displays status
5. Mobile viewport (< 768px): hamburger menu visible, desktop nav hidden
6. Desktop viewport (>= 768px): inline nav visible, hamburger hidden
7. Dark mode toggle switches themes with persistence
8. No CORS errors in browser console
</verification>

<success_criteria>
- Responsive header with sticky positioning, logo, nav links (desktop), hamburger menu (mobile), cart icon, theme toggle
- Mobile navigation drawer using shadcn/ui Sheet component
- Minimal footer with copyright and links
- Dark mode works with system preference detection and manual toggle
- Home page shows successful backend health check (proves full CORS + fetch + TanStack Query pipeline)
- Clean modern aesthetic: white space, subtle borders, rounded corners, muted text
- All TypeScript compiles, production build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/19-monorepo-frontend-foundation/19-03-SUMMARY.md`
</output>
